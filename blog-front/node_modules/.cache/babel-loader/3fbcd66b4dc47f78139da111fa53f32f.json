{"ast":null,"code":"var _jsxFileName = \"/Users/yunsmac/Desktop/blog/src/component/PostDetail.js\",\n    _s = $RefreshSig$();\n\nimport { useParams, useLocation } from \"react-router\";\nimport axios from \"axios\";\nimport { useState, useEffect, useRef } from \"react\";\nimport Header from \"./header/Header\";\nimport styles from \"./PostDetail.module.css\";\nimport { Link, useNavigate } from \"react-router-dom\";\nimport Content from \"./content/Content\";\nimport { token } from \"./Api\";\nimport styled from \"styled-components\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst CommentInput = styled.textarea`\n  width: 90%;\n  height: 80px;\n  border: 1px solid #d3d3d3;\n  border-radius: 3px;\n  &:focus {\n    outline: none;\n  }\n  padding: 5px;\n`;\n_c = CommentInput;\nconst ChildReplyInput = styled(CommentInput)`\n  width: 630px;\n  margin: 20px 0px 5px 0px;\n`;\n_c2 = ChildReplyInput;\nconst CommentContainer = styled.div`\n  height: 800px;\n  padding: 50px;\n`;\n_c3 = CommentContainer;\nconst CommentBox = styled.div`\n  display: flex;\n  width: 100%;\n  justify-content: space-between;\n`;\n_c4 = CommentBox;\nconst CommentBtn = styled.button`\n  width: 60px;\n  height: 50px;\n  margin-left: 40px;\n  font-size: 12px;\n  border: none;\n  border-radius: 4px;\n  background-color: #b4d8e7;\n  color: white;\n  margin: auto 0;\n`;\nconst CommentsUl = styled.ul`\n  margin: 30px 0px;\n  padding: 0;\n`;\n_c5 = CommentsUl;\nconst CommentsLi = styled.li`\n  width: 100%;\n  padding: 0px 10px;\n  list-style: none;\n`;\n_c6 = CommentsLi;\nconst OneComment = styled.div`\n  width: 100%;\n  display: flex;\n  justify-content: space-between;\n  padding: 10px 0px;\n  border-bottom: 1px solid #d3d3d3;\n`;\n_c7 = OneComment;\nconst OneCommentInfo = styled.div`\n  display: flex;\n  flex-direction: column;\n`;\n_c8 = OneCommentInfo;\nconst ReplyBtn = styled(CommentBtn)`\n  width: 60px;\n  height: 30px;\n  margin: auto;\n  margin-left: 10px;\n  &:hover {\n    transform: scale(1.05);\n  }\n  transition: 0.25s;\n`;\n_c9 = ReplyBtn;\nconst ReplyDeleteBox = styled.div``;\n_c10 = ReplyDeleteBox;\nconst ChildReplyForm = styled.form`\n  margin-left: 50px;\n`;\n_c11 = ChildReplyForm;\nconst ChildReplies = styled.ul`\n  padding: 0px;\n`;\n_c12 = ChildReplies;\nconst ChildOneComment = styled(OneComment)`\n  padding: 10px 0px 10px 60px;\n  display: flex;\n  justify-content: space-between;\n`;\n_c13 = ChildOneComment;\n\nfunction PostDetail(props) {\n  _s();\n\n  const {\n    postId\n  } = useParams();\n  const navigate = useNavigate();\n  const [childReply, setChildReply] = useState(false);\n  const [imgUrl, setImgUrl] = useState([]);\n  const [clickChildReplyIndex, setClickChildReply] = useState();\n  const [writer, setWriter] = useState();\n  const [postTime, setPostTime] = useState();\n  const [title, setTitle] = useState();\n  const [content, setContent] = useState();\n  const [comments, setComments] = useState([]);\n  const [parentContent, setParentContent] = useState([]);\n  const textRef = useRef();\n  const [replyNum, setReplyNum] = useState(); //window.scrollTo(0, 0);\n  //const token = \"eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiIxIiwiaXNzIjoiYmxvZyBwcm9qZWN0IiwiaWF0IjoxNjQ0MDQyNDcwLCJleHAiOjE2NTI2ODI0NzB9.NCoq6o8qLnWoBqw6ob3gOhVDR87ZGgruPiGeWEhyfOugC3ZNjCFFcF-Dn7xUInFYfNv8XY-yKznCQWqj8qX1rw\";\n\n  const getResponse = () => {\n    console.log(\"postId:\", postId);\n    console.log(`http://localhost:8080/api/posts/${postId}`);\n\n    var axios = require(\"axios\");\n\n    var data = JSON.stringify({});\n    var config = {\n      method: \"get\",\n      url: `http://localhost:8080/api/posts/${postId}`,\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: \"Bearer \" + token\n      },\n      data: data\n    };\n    axios(config).then(function (response) {\n      console.log(response.data);\n      console.log(\"getResponse에서 받아옴:\", response.data.replyResponseList); // 이게 comments임\n\n      let result = response.data.replyResponseList;\n      const str = response.data.content.split(\",\");\n      const urls = str[0].split(\" \");\n      const content = str[1];\n      console.log(urls);\n      console.log(content);\n      setContent(content);\n      setImgUrl(urls); // if (\n      //   str[0].includes(\n      //     \"https://blog-img-store2.s3.ap-northeast-2.amazonaws.com\"\n      //   )\n      // ) {\n      //   const urlImage = str[0];\n      //   setContent(str.slice(1).join(\" \").toString());\n      //   setImgUrl(urlImage);\n      // } else {\n      //   setContent(response.data.content);\n      // }\n\n      countReply(response.data.replyResponseList);\n      setWriter(response.data.userInfo.username);\n      setPostTime(response.data.chgDt);\n      setComments(result);\n      setTitle(response.data.title);\n    }).catch(function (error) {\n      console.log(error);\n    });\n  };\n\n  const onDelete = event => {\n    event.preventDefault(); //원래 페이지로 돌아가기 */\n\n    console.log(\"삭제버튼누름\");\n\n    var axios = require(\"axios\");\n\n    var data = JSON.stringify(\"string\");\n    var config = {\n      method: \"delete\",\n      url: `http://localhost:8080/api/posts/${postId}`,\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: \"Bearer \" + token\n      },\n      data: data\n    };\n    axios(config).then(function (response) {\n      console.log(JSON.stringify(response.data));\n      navigate(\"/\");\n    }).catch(function (error) {\n      console.log(error);\n    });\n  };\n\n  useEffect(() => {\n    getResponse();\n  }, []);\n\n  const countReply = replyList => {\n    const eachChildReply = replyList.map(reply => reply.childReplyDtoList.length);\n    const childReplySum = eachChildReply.reduce(function (accumulator, currentValue) {\n      return accumulator + currentValue;\n    }, 0);\n    setReplyNum(replyList.length + childReplySum);\n  };\n\n  const replySubmit = () => {\n    let text = textRef.current.value;\n    textRef.current.value = \"\";\n\n    var axios = require(\"axios\");\n\n    var data = JSON.stringify({\n      content: text,\n      parentReplyId: 0,\n      postId: postId\n    });\n    var config = {\n      method: \"post\",\n      url: \"http://localhost:8080/api/reply\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: \"Bearer \" + token\n      },\n      data: data\n    };\n    axios(config).then(function (response) {\n      setComments(response.data.replyResponseList);\n      const replyList = response.data.replyResponseList;\n      countReply(replyList);\n    }).catch(function (error) {\n      console.log(error);\n    });\n  };\n\n  const createChildReply = replyId => {\n    setChildReply(current => !current);\n    setClickChildReply(replyId); //getResponse();\n\n    console.log(\"클릭한 +버튼\", replyId);\n  };\n\n  const [childReplyTyping, setChildReplyType] = useState();\n  /* const postChildReply = (e) => {\n    setChildReplyType(e.target.value);\n  }; */\n\n  const childReplySubmit = e => {\n    // 자식 댓글 등록하기\n    setChildReplyType(\"\");\n    setChildReply(false);\n    e.preventDefault();\n    console.log(\"자식 댓글 담\");\n\n    var axios = require(\"axios\");\n\n    var data = JSON.stringify({\n      content: childReplyTyping,\n      parentReplyId: clickChildReplyIndex,\n      postId: postId\n    });\n    var config = {\n      method: \"post\",\n      url: \"http://localhost:8080/api/reply\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: \"Bearer \" + token\n      },\n      data: data\n    };\n    axios(config).then(function (response) {\n      setComments(response.data.replyResponseList);\n      getResponse();\n    }).catch(function (error) {\n      console.log(error);\n    });\n  };\n\n  const deleteChildReply = replyId => {\n    console.log(\"삭제 버튼\", replyId);\n\n    var axios = require(\"axios\");\n\n    var data = JSON.stringify({});\n    var config = {\n      method: \"delete\",\n      url: `http://localhost:8080/api/reply/${replyId}`,\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: \"Bearer \" + token\n      },\n      data: data\n    };\n    axios(config).then(function (response) {\n      getResponse();\n    }).catch(function (error) {\n      console.log(error);\n    });\n  };\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(Header, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 330,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: styles.container,\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 332,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: styles.postContainer,\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: styles.postTitle,\n          children: title\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 334,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: styles.BtnContainer,\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            children: writer\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 336,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            children: [postTime === null || postTime === void 0 ? void 0 : postTime.slice(0, 10), \" \", postTime === null || postTime === void 0 ? void 0 : postTime.slice(11, 19)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 337,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(Link, {\n            to: \"/modify\",\n            state: {\n              title: title,\n              content: content,\n              postId: postId,\n              imgUrl: imgUrl\n            },\n            children: /*#__PURE__*/_jsxDEV(\"button\", {\n              className: styles.Btn,\n              children: \"\\uC218\\uC815\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 349,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 340,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: styles.Btn,\n            onClick: onDelete,\n            children: \"\\uC0AD\\uC81C\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 351,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 335,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: styles.postContent,\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: styles.img_container,\n            children: urls && urls.map(url => /*#__PURE__*/_jsxDEV(\"img\", {\n              src: \"url\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 358,\n              columnNumber: 31\n            }, this))\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 356,\n            columnNumber: 13\n          }, this), content]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 355,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(CommentContainer, {\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            style: {\n              color: \"#1e6b7b\"\n            },\n            children: [\"\\uB313\\uAE00 \", replyNum]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 364,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(CommentBox, {\n            children: [/*#__PURE__*/_jsxDEV(CommentInput, {\n              ref: textRef,\n              type: \"text\",\n              wrap: \"hard\",\n              onKeyPress: e => {\n                if (e.key == \"Enter\" && textRef !== null) {}\n              }\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 366,\n              columnNumber: 15\n            }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n              children: /*#__PURE__*/_jsxDEV(ReplyBtn, {\n                onClick: replySubmit,\n                children: \"\\uC785\\uB825\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 376,\n                columnNumber: 17\n              }, this)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 375,\n              columnNumber: 15\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 365,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(CommentsUl, {\n            children: comments === null || comments === void 0 ? void 0 : comments.map((reply, index) => {\n              var _reply$childReplyDtoL;\n\n              return /*#__PURE__*/_jsxDEV(CommentsLi, {\n                children: [/*#__PURE__*/_jsxDEV(OneComment, {\n                  children: [/*#__PURE__*/_jsxDEV(OneCommentInfo, {\n                    children: [/*#__PURE__*/_jsxDEV(\"h5\", {\n                      style: {\n                        fontWeight: \"bold\"\n                      },\n                      children: reply.parentReplyDto.userInfo.username\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 385,\n                      columnNumber: 23\n                    }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                      children: reply.parentReplyDto.content\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 388,\n                      columnNumber: 23\n                    }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                      style: {\n                        marginTop: 10,\n                        fontSize: 12,\n                        color: \"#d3d3d3\"\n                      },\n                      children: [reply.parentReplyDto.chgDt.slice(0, 10), \" \", reply.parentReplyDto.chgDt.slice(11, 19)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 389,\n                      columnNumber: 23\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 384,\n                    columnNumber: 21\n                  }, this), /*#__PURE__*/_jsxDEV(ReplyDeleteBox, {\n                    children: [/*#__PURE__*/_jsxDEV(ReplyBtn, {\n                      id: reply.parentReplyDto.replyId,\n                      onClick: e => createChildReply(reply.parentReplyDto.replyId),\n                      children: \"\\uB2F5\\uAE00\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 401,\n                      columnNumber: 23\n                    }, this), /*#__PURE__*/_jsxDEV(ReplyBtn, {\n                      onClick: () => deleteChildReply(reply.parentReplyDto.replyId),\n                      children: \"\\uC0AD\\uC81C\"\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 409,\n                      columnNumber: 23\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 400,\n                    columnNumber: 21\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 383,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(ChildReplyForm, {\n                  onSubmit: childReplySubmit,\n                  children: clickChildReplyIndex === reply.parentReplyDto.replyId && childReply ? /*#__PURE__*/_jsxDEV(\"div\", {\n                    children: [/*#__PURE__*/_jsxDEV(ChildReplyInput, {\n                      type: \"text\",\n                      onChange: e => {\n                        setChildReplyType(e.target.value);\n                      }\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 423,\n                      columnNumber: 25\n                    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                      children: /*#__PURE__*/_jsxDEV(ReplyBtn, {\n                        style: {\n                          float: \"left\",\n                          marginLeft: 0\n                        },\n                        children: [\" \", \"\\uB4F1\\uB85D\"]\n                      }, void 0, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 430,\n                        columnNumber: 27\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 429,\n                      columnNumber: 25\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 422,\n                    columnNumber: 23\n                  }, this) : null\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 419,\n                  columnNumber: 19\n                }, this), /*#__PURE__*/_jsxDEV(ChildReplies, {\n                  children: (_reply$childReplyDtoL = reply.childReplyDtoList) === null || _reply$childReplyDtoL === void 0 ? void 0 : _reply$childReplyDtoL.map(child => /*#__PURE__*/_jsxDEV(ChildOneComment, {\n                    children: [/*#__PURE__*/_jsxDEV(OneCommentInfo, {\n                      children: [/*#__PURE__*/_jsxDEV(\"h5\", {\n                        style: {\n                          fontWeight: \"bold\"\n                        },\n                        children: child.userInfo.username\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 442,\n                        columnNumber: 27\n                      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                        children: child.content\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 445,\n                        columnNumber: 27\n                      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                        style: {\n                          marginTop: 10,\n                          fontSize: 12,\n                          color: \"#d3d3d3\"\n                        },\n                        children: [child.chgDt.slice(0, 10), \" \", child.chgDt.slice(11, 19)]\n                      }, void 0, true, {\n                        fileName: _jsxFileName,\n                        lineNumber: 446,\n                        columnNumber: 27\n                      }, this)]\n                    }, void 0, true, {\n                      fileName: _jsxFileName,\n                      lineNumber: 441,\n                      columnNumber: 25\n                    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                      children: /*#__PURE__*/_jsxDEV(ReplyBtn, {\n                        style: {},\n                        onClick: () => deleteChildReply(child.replyId),\n                        children: \"\\uC0AD\\uC81C\"\n                      }, void 0, false, {\n                        fileName: _jsxFileName,\n                        lineNumber: 458,\n                        columnNumber: 27\n                      }, this)\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 457,\n                      columnNumber: 25\n                    }, this)]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 440,\n                    columnNumber: 23\n                  }, this))\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 438,\n                  columnNumber: 19\n                }, this)]\n              }, reply.parentReplyDto.replyId, true, {\n                fileName: _jsxFileName,\n                lineNumber: 382,\n                columnNumber: 17\n              }, this);\n            })\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 380,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 363,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 333,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 331,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 329,\n    columnNumber: 5\n  }, this);\n}\n\n_s(PostDetail, \"yIRRdYnZR40eLUOzhsuc7LUCo98=\", false, function () {\n  return [useParams, useNavigate];\n});\n\n_c14 = PostDetail;\nexport default PostDetail;\n\nvar _c, _c2, _c3, _c4, _c5, _c6, _c7, _c8, _c9, _c10, _c11, _c12, _c13, _c14;\n\n$RefreshReg$(_c, \"CommentInput\");\n$RefreshReg$(_c2, \"ChildReplyInput\");\n$RefreshReg$(_c3, \"CommentContainer\");\n$RefreshReg$(_c4, \"CommentBox\");\n$RefreshReg$(_c5, \"CommentsUl\");\n$RefreshReg$(_c6, \"CommentsLi\");\n$RefreshReg$(_c7, \"OneComment\");\n$RefreshReg$(_c8, \"OneCommentInfo\");\n$RefreshReg$(_c9, \"ReplyBtn\");\n$RefreshReg$(_c10, \"ReplyDeleteBox\");\n$RefreshReg$(_c11, \"ChildReplyForm\");\n$RefreshReg$(_c12, \"ChildReplies\");\n$RefreshReg$(_c13, \"ChildOneComment\");\n$RefreshReg$(_c14, \"PostDetail\");","map":{"version":3,"sources":["/Users/yunsmac/Desktop/blog/src/component/PostDetail.js"],"names":["useParams","useLocation","axios","useState","useEffect","useRef","Header","styles","Link","useNavigate","Content","token","styled","CommentInput","textarea","ChildReplyInput","CommentContainer","div","CommentBox","CommentBtn","button","CommentsUl","ul","CommentsLi","li","OneComment","OneCommentInfo","ReplyBtn","ReplyDeleteBox","ChildReplyForm","form","ChildReplies","ChildOneComment","PostDetail","props","postId","navigate","childReply","setChildReply","imgUrl","setImgUrl","clickChildReplyIndex","setClickChildReply","writer","setWriter","postTime","setPostTime","title","setTitle","content","setContent","comments","setComments","parentContent","setParentContent","textRef","replyNum","setReplyNum","getResponse","console","log","require","data","JSON","stringify","config","method","url","headers","Authorization","then","response","replyResponseList","result","str","split","urls","countReply","userInfo","username","chgDt","catch","error","onDelete","event","preventDefault","replyList","eachChildReply","map","reply","childReplyDtoList","length","childReplySum","reduce","accumulator","currentValue","replySubmit","text","current","value","parentReplyId","createChildReply","replyId","childReplyTyping","setChildReplyType","childReplySubmit","e","deleteChildReply","container","postContainer","postTitle","BtnContainer","slice","Btn","postContent","img_container","color","key","index","fontWeight","parentReplyDto","marginTop","fontSize","target","float","marginLeft","child"],"mappings":"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","sourcesContent":["import { useParams, useLocation } from \"react-router\";\nimport axios from \"axios\";\nimport { useState, useEffect, useRef } from \"react\";\nimport Header from \"./header/Header\";\nimport styles from \"./PostDetail.module.css\";\nimport { Link, useNavigate } from \"react-router-dom\";\nimport Content from \"./content/Content\";\nimport { token } from \"./Api\";\nimport styled from \"styled-components\";\n\nconst CommentInput = styled.textarea`\n  width: 90%;\n  height: 80px;\n  border: 1px solid #d3d3d3;\n  border-radius: 3px;\n  &:focus {\n    outline: none;\n  }\n  padding: 5px;\n`;\n\nconst ChildReplyInput = styled(CommentInput)`\n  width: 630px;\n  margin: 20px 0px 5px 0px;\n`;\n\nconst CommentContainer = styled.div`\n  height: 800px;\n  padding: 50px;\n`;\n\nconst CommentBox = styled.div`\n  display: flex;\n  width: 100%;\n  justify-content: space-between;\n`;\n\nconst CommentBtn = styled.button`\n  width: 60px;\n  height: 50px;\n  margin-left: 40px;\n  font-size: 12px;\n  border: none;\n  border-radius: 4px;\n  background-color: #b4d8e7;\n  color: white;\n  margin: auto 0;\n`;\n\nconst CommentsUl = styled.ul`\n  margin: 30px 0px;\n  padding: 0;\n`;\n\nconst CommentsLi = styled.li`\n  width: 100%;\n  padding: 0px 10px;\n  list-style: none;\n`;\n\nconst OneComment = styled.div`\n  width: 100%;\n  display: flex;\n  justify-content: space-between;\n  padding: 10px 0px;\n  border-bottom: 1px solid #d3d3d3;\n`;\n\nconst OneCommentInfo = styled.div`\n  display: flex;\n  flex-direction: column;\n`;\n\nconst ReplyBtn = styled(CommentBtn)`\n  width: 60px;\n  height: 30px;\n  margin: auto;\n  margin-left: 10px;\n  &:hover {\n    transform: scale(1.05);\n  }\n  transition: 0.25s;\n`;\n\nconst ReplyDeleteBox = styled.div``;\n\nconst ChildReplyForm = styled.form`\n  margin-left: 50px;\n`;\n\nconst ChildReplies = styled.ul`\n  padding: 0px;\n`;\n\nconst ChildOneComment = styled(OneComment)`\n  padding: 10px 0px 10px 60px;\n  display: flex;\n  justify-content: space-between;\n`;\n\nfunction PostDetail(props) {\n  const { postId } = useParams();\n  const navigate = useNavigate();\n  const [childReply, setChildReply] = useState(false);\n  const [imgUrl, setImgUrl] = useState([]);\n  const [clickChildReplyIndex, setClickChildReply] = useState();\n  const [writer, setWriter] = useState();\n  const [postTime, setPostTime] = useState();\n  const [title, setTitle] = useState();\n  const [content, setContent] = useState();\n  const [comments, setComments] = useState([]);\n  const [parentContent, setParentContent] = useState([]);\n  const textRef = useRef();\n  const [replyNum, setReplyNum] = useState();\n\n  //window.scrollTo(0, 0);\n\n  //const token = \"eyJhbGciOiJIUzUxMiJ9.eyJzdWIiOiIxIiwiaXNzIjoiYmxvZyBwcm9qZWN0IiwiaWF0IjoxNjQ0MDQyNDcwLCJleHAiOjE2NTI2ODI0NzB9.NCoq6o8qLnWoBqw6ob3gOhVDR87ZGgruPiGeWEhyfOugC3ZNjCFFcF-Dn7xUInFYfNv8XY-yKznCQWqj8qX1rw\";\n\n  const getResponse = () => {\n    console.log(\"postId:\", postId);\n    console.log(`http://localhost:8080/api/posts/${postId}`);\n\n    var axios = require(\"axios\");\n    var data = JSON.stringify({});\n\n    var config = {\n      method: \"get\",\n      url: `http://localhost:8080/api/posts/${postId}`,\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: \"Bearer \" + token,\n      },\n      data: data,\n    };\n\n    axios(config)\n      .then(function (response) {\n        console.log(response.data);\n        console.log(\"getResponse에서 받아옴:\", response.data.replyResponseList); // 이게 comments임\n\n        let result = response.data.replyResponseList;\n        const str = response.data.content.split(\",\");\n        const urls = str[0].split(\" \")\n        const content = str[1];\n\n        console.log(urls);\n        console.log(content);\n        setContent(content);\n        setImgUrl(urls)\n        \n        // if (\n        //   str[0].includes(\n        //     \"https://blog-img-store2.s3.ap-northeast-2.amazonaws.com\"\n        //   )\n        // ) {\n        //   const urlImage = str[0];\n        //   setContent(str.slice(1).join(\" \").toString());\n\n        //   setImgUrl(urlImage);\n        // } else {\n        //   setContent(response.data.content);\n        // }\n        \n\n        countReply(response.data.replyResponseList);\n        setWriter(response.data.userInfo.username);\n        setPostTime(response.data.chgDt);\n        setComments(result);\n        setTitle(response.data.title);\n      })\n      .catch(function (error) {\n        console.log(error);\n      });\n  };\n\n  const onDelete = (event) => {\n    event.preventDefault();\n\n    //원래 페이지로 돌아가기 */\n    console.log(\"삭제버튼누름\");\n    var axios = require(\"axios\");\n    var data = JSON.stringify(\"string\");\n\n    var config = {\n      method: \"delete\",\n      url: `http://localhost:8080/api/posts/${postId}`,\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: \"Bearer \" + token,\n      },\n      data: data,\n    };\n\n    axios(config)\n      .then(function (response) {\n        console.log(JSON.stringify(response.data));\n        navigate(\"/\");\n      })\n      .catch(function (error) {\n        console.log(error);\n      });\n  };\n\n  useEffect(() => {\n    getResponse();\n  }, []);\n\n  const countReply = (replyList) => {\n    const eachChildReply = replyList.map(\n      (reply) => reply.childReplyDtoList.length\n    );\n\n    const childReplySum = eachChildReply.reduce(function (\n      accumulator,\n      currentValue\n    ) {\n      return accumulator + currentValue;\n    },\n    0);\n\n    setReplyNum(replyList.length + childReplySum);\n  };\n  const replySubmit = () => {\n    let text = textRef.current.value;\n    textRef.current.value = \"\";\n\n    var axios = require(\"axios\");\n    var data = JSON.stringify({\n      content: text,\n      parentReplyId: 0,\n      postId: postId,\n    });\n\n    var config = {\n      method: \"post\",\n      url: \"http://localhost:8080/api/reply\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: \"Bearer \" + token,\n      },\n      data: data,\n    };\n\n    axios(config)\n      .then(function (response) {\n        setComments(response.data.replyResponseList);\n\n        const replyList = response.data.replyResponseList;\n\n        countReply(replyList);\n      })\n      .catch(function (error) {\n        console.log(error);\n      });\n  };\n  const createChildReply = (replyId) => {\n    setChildReply((current) => !current);\n    setClickChildReply(replyId);\n    //getResponse();\n    console.log(\"클릭한 +버튼\", replyId);\n  };\n\n  const [childReplyTyping, setChildReplyType] = useState();\n\n  /* const postChildReply = (e) => {\n    setChildReplyType(e.target.value);\n  }; */\n\n  const childReplySubmit = (e) => {\n    // 자식 댓글 등록하기\n    setChildReplyType(\"\");\n    setChildReply(false);\n\n    e.preventDefault();\n    console.log(\"자식 댓글 담\");\n    var axios = require(\"axios\");\n    var data = JSON.stringify({\n      content: childReplyTyping,\n      parentReplyId: clickChildReplyIndex,\n      postId: postId,\n    });\n\n    var config = {\n      method: \"post\",\n      url: \"http://localhost:8080/api/reply\",\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: \"Bearer \" + token,\n      },\n      data: data,\n    };\n\n    axios(config)\n      .then(function (response) {\n        setComments(response.data.replyResponseList);\n        getResponse();\n      })\n      .catch(function (error) {\n        console.log(error);\n      });\n  };\n\n  const deleteChildReply = (replyId) => {\n    console.log(\"삭제 버튼\", replyId);\n    var axios = require(\"axios\");\n    var data = JSON.stringify({});\n\n    var config = {\n      method: \"delete\",\n      url: `http://localhost:8080/api/reply/${replyId}`,\n      headers: {\n        \"Content-Type\": \"application/json\",\n        Authorization: \"Bearer \" + token,\n      },\n      data: data,\n    };\n\n    axios(config)\n      .then(function (response) {\n        getResponse();\n      })\n      .catch(function (error) {\n        console.log(error);\n      });\n  };\n\n  return (\n    <div>\n      <Header />\n      <div className={styles.container}>\n        <div></div>\n        <div className={styles.postContainer}>\n          <div className={styles.postTitle}>{title}</div>\n          <div className={styles.BtnContainer}>\n            <span>{writer}</span>\n            <span>\n              {postTime?.slice(0, 10)} {postTime?.slice(11, 19)}\n            </span>\n            <Link\n              to={\"/modify\"}\n              state={{\n                title: title,\n                content: content,\n                postId: postId,\n                imgUrl: imgUrl,\n              }}\n            >\n              <button className={styles.Btn}>수정</button>\n              </Link>\n            <button className={styles.Btn} onClick={onDelete}>\n              삭제\n            </button>\n          </div>\n          <div className={styles.postContent}>\n            <div className={styles.img_container}>\n             {urls && (\n              urls.map(url => <img src = \"url\"/>)\n             )}\n            </div>\n            {content}\n          </div>\n          <CommentContainer>\n            <span style={{ color: \"#1e6b7b\" }}>댓글 {replyNum}</span>\n            <CommentBox>\n              <CommentInput\n                ref={textRef}\n                type=\"text\"\n                wrap=\"hard\"\n                onKeyPress={(e) => {\n                  if (e.key == \"Enter\" && textRef !== null) {\n                  }\n                }}\n              />\n              <div>\n                <ReplyBtn onClick={replySubmit}>입력</ReplyBtn>\n              </div>\n            </CommentBox>\n\n            <CommentsUl>\n              {comments?.map((reply, index) => (\n                <CommentsLi key={reply.parentReplyDto.replyId}>\n                  <OneComment>\n                    <OneCommentInfo>\n                      <h5 style={{ fontWeight: \"bold\" }}>\n                        {reply.parentReplyDto.userInfo.username}\n                      </h5>\n                      <span>{reply.parentReplyDto.content}</span>\n                      <span\n                        style={{\n                          marginTop: 10,\n                          fontSize: 12,\n                          color: \"#d3d3d3\",\n                        }}\n                      >\n                        {reply.parentReplyDto.chgDt.slice(0, 10)}{\" \"}\n                        {reply.parentReplyDto.chgDt.slice(11, 19)}\n                      </span>\n                    </OneCommentInfo>\n                    <ReplyDeleteBox>\n                      <ReplyBtn\n                        id={reply.parentReplyDto.replyId}\n                        onClick={(e) =>\n                          createChildReply(reply.parentReplyDto.replyId)\n                        }\n                      >\n                        답글\n                      </ReplyBtn>\n                      <ReplyBtn\n                        onClick={() =>\n                          deleteChildReply(reply.parentReplyDto.replyId)\n                        }\n                      >\n                        삭제\n                      </ReplyBtn>\n                    </ReplyDeleteBox>\n                  </OneComment>\n\n                  <ChildReplyForm onSubmit={childReplySubmit}>\n                    {clickChildReplyIndex === reply.parentReplyDto.replyId &&\n                    childReply ? (\n                      <div>\n                        <ChildReplyInput\n                          type=\"text\"\n                          onChange={(e) => {\n                            setChildReplyType(e.target.value);\n                          }}\n                        />\n                        <div>\n                          <ReplyBtn style={{ float: \"left\", marginLeft: 0 }}>\n                            {\" \"}\n                            등록\n                          </ReplyBtn>\n                        </div>\n                      </div>\n                    ) : null}\n                  </ChildReplyForm>\n                  <ChildReplies>\n                    {reply.childReplyDtoList?.map((child) => (\n                      <ChildOneComment>\n                        <OneCommentInfo>\n                          <h5 style={{ fontWeight: \"bold\" }}>\n                            {child.userInfo.username}\n                          </h5>\n                          <span>{child.content}</span>\n                          <span\n                            style={{\n                              marginTop: 10,\n                              fontSize: 12,\n                              color: \"#d3d3d3\",\n                            }}\n                          >\n                            {child.chgDt.slice(0, 10)}{\" \"}\n                            {child.chgDt.slice(11, 19)}\n                          </span>\n                        </OneCommentInfo>\n                        <div>\n                          <ReplyBtn\n                            style={{}}\n                            onClick={() => deleteChildReply(child.replyId)}\n                          >\n                            삭제\n                          </ReplyBtn>\n                        </div>\n                      </ChildOneComment>\n                    ))}\n                  </ChildReplies>\n                </CommentsLi>\n              ))}\n            </CommentsUl>\n          </CommentContainer>\n        </div>\n      </div>\n    </div>\n  );\n}\n\nexport default PostDetail;\n"]},"metadata":{},"sourceType":"module"}